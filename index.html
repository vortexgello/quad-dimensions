
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Quad Dimensions - Catalog</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
</head>
<body>
  <div class="container">
    <!-- Sidebar with collapse button -->
    <aside class="sidebar" id="sidebar">
      <div class="brand">
        <h1>Quad Dimensions</h1>
        <p class="product-count">Loading...</p>
        <button id="toggleSidebar" style="margin-top:10px;padding:5px 10px;">
          <img id="toggleIcon" src="static/icons/collapse.svg" alt="Toggle Sidebar" style="width: 30px; height: 30px;" />
        </button>
        <button id="themeToggle" style="margin-top:10px;padding:5px 10px;width: 30px; height: 30px;">
          <i class="fas fa-moon" id="themeIcon"></i>
        </button>
      </div>
      <nav class="nav-links">
        <a href="index.html" class="active">Catalog</a>
        <a href="contact.html">Contact</a>
      </nav>
    </aside>

    <!-- Main product display -->
    <main class="main-content">
      <h2>Catalog</h2>

      <div style="margin-bottom: 20px;">
        <input type="text" id="searchInput" placeholder="Search products..." style="padding: 8px; width: 200px; margin-right: 10px;">
        <select id="categoryFilter" style="padding: 8px;">
          <option value="All">All Categories</option>
        </select>
      </div>

      <div id="catalog-sections"></div>
    </main>
  </div>

  <script>
    let allProducts = [];

    function renderCatalog(filteredProducts) {
      const container = document.getElementById('catalog-sections');
      container.innerHTML = '';

      const grouped = {};
      filteredProducts.forEach(p => {
        if (!grouped[p.category]) grouped[p.category] = [];
        grouped[p.category].push(p);
      });

      for (const [category, items] of Object.entries(grouped)) {
        const section = document.createElement('section');
        section.className = 'catalog-section';
        section.innerHTML = '<h3>' + category + '</h3>';

        const grid = document.createElement('div');
        grid.className = 'product-grid';

        items.forEach(product => {
          const card = document.createElement('div');
          card.className = 'product-card';
          card.innerHTML = `
            <img src="${product.thumbnail}" style="width:100%;border-radius:4px;margin-bottom:10px;">
            <h4>${product.name}</h4>
            <a href="${product.pdf}" target="_blank">View PDF</a>
          `;
          grid.appendChild(card);
        });

        section.appendChild(grid);
        container.appendChild(section);
      }

      document.querySelector('.product-count').textContent = filteredProducts.length + " products";
    }

    function filterProducts() {
      const searchText = document.getElementById('searchInput').value.toLowerCase();
      const selectedCategory = document.getElementById('categoryFilter').value;
      const filtered = allProducts.filter(p =>
        (selectedCategory === 'All' || p.category === selectedCategory) &&
        p.name.toLowerCase().includes(searchText)
      );
      renderCatalog(filtered);
    }

    document.addEventListener("DOMContentLoaded", () => {
      fetch("products.json")
        .then(res => res.json())
        .then(products => {
          allProducts = products;
          const categories = Array.from(new Set(products.map(p => p.category)));
          const filterSelect = document.getElementById('categoryFilter');
          categories.forEach(cat => {
            const option = document.createElement('option');
            option.value = cat;
            option.textContent = cat;
            filterSelect.appendChild(option);
          });

          document.getElementById('searchInput').addEventListener('input', filterProducts);
          document.getElementById('categoryFilter').addEventListener('change', filterProducts);

          renderCatalog(products);
        });

      document.getElementById('toggleSidebar').addEventListener('click', () => {
        const sidebar = document.getElementById('sidebar');
        const isCollapsed = sidebar.classList.toggle('collapsed');
        document.getElementById('toggleIcon').src = isCollapsed ? 'static/icons/expand.png' : 'static/icons/collapse.svg';
      });

      // Theme toggle logic
      const themeToggle = document.getElementById('themeToggle');
      const themeIcon = document.getElementById('themeIcon');
      const currentTheme = localStorage.getItem('theme') || 'dark';
      document.body.classList.toggle('light-mode', currentTheme === 'light');
      themeIcon.classList.toggle('fa-sun', currentTheme === 'light');
      themeIcon.classList.toggle('fa-moon', currentTheme !== 'light');

      themeToggle.addEventListener('click', () => {
        const isLight = document.body.classList.toggle('light-mode');
        localStorage.setItem('theme', isLight ? 'light' : 'dark');
        themeIcon.classList.toggle('fa-sun', isLight);
        themeIcon.classList.toggle('fa-moon', !isLight);
      });
    });
  </script>
</body>
</html>
